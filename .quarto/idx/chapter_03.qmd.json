{"title":"Position as a function of time","markdown":{"headingText":"Position as a function of time","containsRefs":false,"markdown":"\nIn the previous chapter we found the relationship between orbital position ($\\vec r$) and true anomaly ($\\theta$) for the two-body problem. But for any meaningful analysis of the orbital motion one would need position as a function of time. For this, we start from the conservation of angular momentum , which we can write as:\n\n$$\nh=r^2\\dot \\theta\n$$\n\nThen,\n\n$$\n\\frac{d\\theta}{dt}=\\frac{h}{r^2}\n$$\n\nIntegrating from perigee position, we get;\n\n$$\n\\int_0^\\theta \\,d\\theta=\\int_{t_p}^t \\frac{h}{r^2} \\,dt\n$$\n\nWhere the true anomaly at perigee is fixed as 0, since eccentricity vector is along the perigee direction from the focus (see @fig-theta for explanation) and time of passing the perigee is taken as $t_p$.\n\n## Case 1: Circular Orbits (e=0)\n\nIn case of circular orbits, $\\dot \\theta$ is a constant since r is a constant. Hence,\n\n$$\n\\theta (t)=\\frac{h}{r^2}(t-t_p)\n$$\n\nIf the object in question passes perigee( because a circle is symmetric about any diameter, you can choose any radius line as the apse-line) at $t_p=0$, and use @eq-rpos with $e=0$ then the equation becomes:\n\n$$\n\\theta (t)=\\frac{h}{\\left(\\frac{h^2}{\\mu}\\right)^2}t=\\frac{\\mu^2}{h^3}t\n$$\n\n## Case 2: Elliptical orbits (0\\<e\\<1)\n\nUsing @eq-rpos and $t_p=0$ ,\n\n$$ \\int_0^\\theta \\,d\\theta=\\int_{0}^t \\frac{h}{\\left(\\frac{h^2}{\\mu}\\right)^2}(1+e\\cos{\\theta})^2 \\,dt $$\n\n$$\n\\int_0^t \\frac{\\mu^2}{h^3}\\,dt=\\int_0^\\theta \\frac{d\\theta}{(1+e\\cos{\\theta})^2}\n$$\n\nCurrently we can find from integral tables that:\n\n$$\n\\int_0^\\theta \\frac{d\\theta}{(1+e\\cos{\\theta})^2}= \\frac{1}{(1-e^2)^{3/2}}\\left[2\\tan^{-1}{\\left(\\sqrt{\\frac{1-e}{1+e}}\\tan{\\frac{\\theta}{2}}\\right)}-\\frac{e\\sqrt{1-e^2}}{1+e\\cos{\\theta}}\\sin{\\theta}\\right]\n$$\n\nAnd therefore,\n\n$$\n\\frac{\\mu^2}{h^3}t=\\frac{1}{(1-e^2)^{3/2}}\\left[2\\tan^{-1}{\\left(\\sqrt{\\frac{1-e}{1+e}}\\tan{\\frac{\\theta}{2}}\\right)}-\\frac{e\\sqrt{1-e^2}}{1+e\\cos{\\theta}}\\sin{\\theta}\\right]\n$$\n\nWe now introduce the quantity of **mean anomaly**, given by:\n\n$$\nM_e=(1-e)^{3/2}\\frac{\\mu^2}{h^3}t\n$$ {#eq-meananomaly}\n\nwhich gives,\n\n$$\nM_e=2\\tan^{-1}{\\left(\\sqrt{\\frac{1-e}{1+e}}\\tan{\\frac{\\theta}{2}}\\right)}-\\frac{e\\sqrt{1-e^2}}{1+e\\cos{\\theta}}\\sin{\\theta}\n$$ {#eq-metheta}\n\nMean anomaly can be described of as the orbital position of a fictitious second body that moves in a circular orbit around the 1st body with the same time period as the second body in our two-body system.\n\n$$\nM_e=\\frac{2\\pi}{T}t\n$$ {#eq-meananomaly2}\n\nwhere $T$ is the time period of the orbit.\n\n![Ellipse and its Auxiliary circle (Fig. 3.3 @curtis2005orbital)](fig3_1.jpeg){#fig-3_1}\n\nWe will see that it becomes convenient to simplify @eq-metheta by introducing an auxiliary angle $E$ called the eccentric anomaly, which is done by circumscribing the ellipse with a concentric auxiliary circle having radius equal to the semi-major axis $a$ of the ellipse. (Shown in @fig-3_1). Where $S$ is the current position with true anomaly $\\theta$ and $Q$ is the projected point onto the auxiliary circle.\n\nFrom the figure, we can observe that $\\overline{OV}=a\\cos E$ in terms of eccentric anomaly while $\\overline{OV}= ae + r\\cos \\theta$ in terms of true anomaly. Thus,\n\n$$\na\\cos E=ae + r\\cos \\theta\n$$\n\nUsing the parametric equation of ellipse @eq-ellipse with the semi-latus rectum $p=a(1-e^2)$, we can write this as\n\n$$\na\\cos E=ae + \\frac{a(1-e^2)}{1+e\\cos \\theta}\\cos \\theta\n$$\n\nOn simplification,\n\n$$\n\\cos E = \\frac{e+\\cos \\theta}{1+ e\\cos \\theta}\n$$ {#eq-cosE}\n\nUsing $\\cos^2 E + \\sin^2 E=1$;\n\n$$\n\\sin E= \\frac{ \\sqrt{1-e^2} \\sin \\theta}{1+e\\cos \\theta}\n$$ {#eq-sinE}\n\nWhile using either of @eq-cosE or @eq-sinE is fine for obtaining $E$ from $\\theta$, however, given a value of $\\cos E/\\sin E$ between -1 and 1. there are two values of $E \\in [0,2\\pi]$. To resolve the quadrant ambiguity, one is forced to check the other equation. Instead of that, we can use the following:\n\n$$\n\\tan^2 \\frac{E}{2} = \\frac{\\sin^2 \\frac{E}{2}}{\\cos^2 \\frac{E}{2}}= \\frac{1-\\cos E}{1+\\cos E}\n$$\n\nAnd using @eq-cosE on numerator and denominator,\n\n$$\n1-\\cos E=1-\\frac{e+\\cos \\theta}{1+ e\\cos \\theta}=\\frac{(1-e)(1-\\cos \\theta)}{1+ e\\cos \\theta}\n$$\n\n$$\n1+\\cos E= 1+\\frac{e+\\cos \\theta}{1+ e\\cos \\theta}=\\frac{(1+e)(1+\\cos \\theta)}{1+ e\\cos \\theta}\n$$\n\nTherefore,\n\n$$\n\\tan^2 \\frac{E}{2} = \\frac{1-\\cos E}{1+\\cos E}= \\frac{(1-e)(1-\\cos \\theta)}{(1+e)(1+\\cos \\theta)}=\\frac{1-e}{1+e} \\tan^2 \\frac{\\theta}{2}\n$$\n\n$$\n\\boxed{\\tan \\frac{E}{2}=\\sqrt{\\frac{1-e}{1+e}}\\tan \\frac{\\theta}{2}}\n$$ {#eq-tane/2}\n\nUsing @eq-tane/2 and @eq-sinE on @eq-metheta\n\n$$\n M_e=2\\tan^{-1}{\\left(\\sqrt{\\frac{1-e}{1+e}}\\tan{\\frac{\\theta}{2}}\\right)}-\\frac{e\\sqrt{1-e^2}}{1+e\\cos{\\theta}}\\sin{\\theta}\n$$\n\nwe get,\n\n$$\n\\boxed{M_e= E-\\sin E}\n$$ {#eq-keplereq}\n\nThis is known as the **Kepler's equation**.Now, given the time-period ($T$), eccentricity ($e$) and the true anomaly($\\theta$) position of an object in orbit, we will:\n\n1.  find $E=2\\tan^{-1}{\\left(\\sqrt{\\frac{1-e}{1+e}}\\tan \\frac{f}{2}\\right)}$\n\n2.  Solve Kepler's equation to get $M_e$\n\n3.  get the time since the previous perigee passing from @eq-meananomaly .\n\nNow looking back at history, we would see that Kepler derived this equation way before Newton formulated the principles of calculus. One could ask how he derived this relationship between two quantities that had not much of a physical significance before. This is the question that we will try to answer in the following section.\n\n## Keplerian geometrical derivation\n\nKepler knew from his *Second Law* (equal areas in equal times) that time must be proportional to the area swept out by the radius vector. Which implies,\n\n$$\n\\frac{A(t)}{\\pi ab}=\\frac{t}{T}\n$$ {#eq-aoft}\n\n### Kepler's reason for eccentric anomaly\n\nIt’s difficult to measure the swept area directly in an ellipse. Instead, Kepler mapped point $P$ on the ellipse to point $Q$ on the auxiliary circle. He then used the circle’s geometry to calculate areas. So if we can express $A(E)$ as a function of $E$, we can connect time $t$ to its position.\n\n### Calculation of the swept out area\n\nIn @fig-3_1, the area swept out by the radius vector $FP$ from periapsis $A$ to the body $P$ (the shaded region $AFP$) is what Kepler’s Second Law refers to. This area $A(E)$ can be obtained by relating it to easier-to-compute parts:\n\n1.  **Sector** $AOQ$ in the circle: Its area is $\\tfrac{1}{2}a^2 E$.\n\n2.  **Ellipse correction**: Since the ellipse is “squashed” vertically by a factor $b/a$, the corresponding ellipse area is scaled: $\\tfrac{1}{2}ab E$.\n\n3.  **Shift from center** $O$ to focus $F$: The ellipse area computed above is referenced to the center, not the focus. To correct, subtract the triangular area $FQS$. That triangle has area: $\\tfrac{1}{2}ab e \\sin E$.\n\nSo the true area from periapsis to $P$ is:\n\n$$\nA(E) = \\frac{ab}{2} \\left( E - e \\sin E \\right).\n$$\n\n### Connecting eccentric anomaly to mean anomaly\n\nNow using both @eq-aoft and @eq-meananomaly2, and let $E$ be the eccentric anomaly of the orbiting body at time $t$. Hence,\n\n$$\nA(t)=\\frac{ab}{2}(E-e\\sin E)=\\frac{\\pi ab}{T}t\n$$\n\nAnd,\n\n$$\nM=\\frac{2\\pi}{T}t\n$$\n\nWe get,$$\nM = \\frac{2\\pi}{T}t = E - e\\sin E.\n$$\n\nThis is exactly the same as @eq-keplereq.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"css":["styles.css"],"output-file":"chapter_03.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","bibliography":["references.bib"],"jupyter":{"kernelspec":{"name":"python3","display_name":"Python 3.12.5","language":"python"}},"theme":{"light":"cosmo","dark":"darkly"},"math":"mathjax"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}